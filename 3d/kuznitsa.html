<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
    	<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>My first three.js app</title>
		<style>
			* {margin:0;padding:0;}
			body {overflow: hidden;}
			.container {width: 100%; height: 100vh; cursor: move;}
		</style>
	</head>
	<body>
		<div class="container"></div>
		<!-- Since import maps are not yet supported by all browsers, it is necessary to add the polyfill es-module-shims.js. -->
		<script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script>
		<!-- Загружаем библиотеки из облака-->
		<script type="importmap">
			{
			  "imports": {
				"three": "https://unpkg.com/three@0.150.0/build/three.module.js",
				"three/addons/": "https://unpkg.com/three@0.150.0/examples/jsm/"
			  }
			}
		  </script>
		<!-- Подключем библиотеки-->
		<script type="module">
			import * as THREE from 'three';
			import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
            import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
			import { FBXLoader } from 'three/addons/loaders/FBXLoader.js';

			//хз как и чего
			function init() {
            	let container = document.querySelector('.container');

				//const scene, const camera, const renderer - обязательные параметры
				//Без них, function animate и light объект не появится
				const scene = new THREE.Scene();
				const camera = new THREE.PerspectiveCamera( 15, window.innerWidth / window.innerHeight, 0.1, 1000 ); //FOV, aspectratio=ширина/высота,?,?)
				camera.position.set(-1, 0.3, -1) //(наклон по оси X,наклон по оси Y, ?)
				
				// Здесь всё стандартные настройки
				const renderer = new THREE.WebGLRenderer({alpha: true, antialias: true}); //alpha: true - чтобы был прозрачный фон, antialias: true - чтобы объекты были сглажены
				renderer.setSize( window.innerWidth, window.innerHeight );
				container.appendChild( renderer.domElement ); //обращаемся к нашему классу container

				//Пространственный свет
				const ambient = new THREE.AmbientLight (0xffffff, 1); //(color : Integer, intensity : Float )
				scene.add(animate)

				const light = new THREE.HemisphereLight( 0xffffff, 0x080820, 0.5  ); //(skyColor : Integer, groundColor : Integer, intensity : Float)
				scene.add( light );

				//Направленный свет
				//const directlight = new THREE.DirectionalLight (0xc4c4c4, 1); // (color : Integer, intensity : Float, distance : Number, decay : Float)
				//directlight.position.set(0,1,0);
				//directlight.castShadow = true;
				//scene.add(directlight)
				// Helper Показать где источник света
                // const helper = new THREE.PointLightHelper(directlight)
                // scene.add(helper)

				/*//Точечный свет
				const light = new THREE.PointLight (0xe81313, 10); // (color : Integer, intensity : Float, distance : Number, decay : Float)
				light.position.set(0,0,0); // middle of the scene - (0, 0, 0)
				scene.add(light);
				// Helper Показать где источник света
				const helper = new THREE.PointLightHelper(light)
                scene.add(helper)

				//Точечный свет
				const light2 = new THREE.PointLight (0x131ae8, 10); 
				light2.position.set(50,10,0); 
				scene.add(light2);
				// Helper Показать где источник света
                const helper2 = new THREE.PointLightHelper(light2);
                scene.add(helper2);

				//Точечный свет
				const light3 = new THREE.PointLight (0x1bc41e, 10);
				light3.position.set(0,10,-50);
				scene.add(light3);
				// Helper Показать где источник света
                const helper3 = new THREE.PointLightHelper(light3);
                scene.add(helper3);

				//Точечный свет
				const light4 = new THREE.PointLight (0x1bc2c4, 10);
				light4.position.set(-50,30,0);
				scene.add(light4);
				// Helper Показать где источник света
                const helper4 = new THREE.PointLightHelper(light4);
                scene.add(helper4);*/

				/*//Подгружаем модель с помощью GLTFLoader//
				const loader = new GLTFLoader();
				loader.load( './wooden/scene.gltf', function ( gltf ) {
					gltf.scene.position.set (0.0,-1.5,0.0); //Расположение центра дома по осям
					gltf.scene.scale.set (0.5,0.5,0.5); //Размер дома
					scene.add( gltf.scene );
				}, undefined, function ( error ) {
					console.error( error );
				} );*/

				//Подгружаем модель с помощью FBXLoader//
				const fbxloader = new FBXLoader();
				fbxloader.load( './models/kuznitsa.fbx', ( object ) => {
					object.position.set (-3.05,0.0,-3.1); //Расположение центра дома по осям (redAxis, greenZ, blueAxis)
					object.scale.set (0.1,0.1,0.1); //Размер дома
					object.rotateX(Math.PI / 2) //Повернуть камеру
					object.rotateY(Math.PI) //Повернуть камеру
					scene.add( object );
				}, undefined, function ( error ) {
					console.error( error );
				} );


				//Подгружаем модуль, позволюящий вращать камеру //
				const controls = new OrbitControls( camera, renderer.domElement );
				controls.update();
				controls.autoRotate = true; //Включить вращение
          		controls.autoRotateSpeed = 1; //Скорость вращения
				controls.enableDamping = true; //Сглаживает повороты
				controls.minDistance = 30; //Миниимальная дистанция, чтобы камера не могла заходить в модель
				//const axesHelper = new THREE.AxesHelper( 5 ); //Задать праметры осей
				//scene.add( axesHelper ); //Добавить оси на сцену

				//Resize под размер окна браузера
				window.addEventListener('resize', onWindowResize, false)
            
           	 	function onWindowResize() {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();

                renderer.setSize(window.innerWidth, window.innerHeight)
            }

				// Тоже обязательная вещь. Нужна "для создания плавной картинки". requestAnimationFrame(animate) - отключается при переходе пользователя в другую вкладку
				function animate() {
					requestAnimationFrame(animate);
					controls.update(); // нужна, если есть модуль OrbitControls
					renderer.render(scene, camera)
				}
				animate()
			}
			init()
		</script>
	</body>
</html>